# Batch

## 命令

### 批处理与脚本控制

#### `echo`

##### 基本语法

```bash
echo [on | off]
echo [message]
```

##### 参数说明

| 参数/形式      | 说明                                                     |
| -------------- | -------------------------------------------------------- |
| `echo`         | 显示当前 `echo` 状态（ON 或 OFF）                        |
| `echo on`      | 打开命令显示，在执行脚本时显示命令本身                   |
| `echo off`     | 关闭命令显示，只显示输出，不显示命令本身                 |
| `@echo off`    | 在关闭命令显示的同时，不显示当前这一行（常用于脚本首行） |
| `echo message` | 在控制台输出一段文本                                     |
| `echo.`        | 输出空行（注意：后面有一个英文点号）                     |
| `echo:`        | 也可用来输出空行（兼容性略差）                           |
| `echo > file`  | 将文本重定向输出到文件                                   |

##### `>` 与 `>>` 的区别

| 符号 | 作用                             | 文件已存在时的行为         |
| ---- | -------------------------------- | -------------------------- |
| `>`  | **覆盖写入**（新建或清空再写入） | 会**清空原文件内容后写入** |
| `>>` | **追加写入**                     | 在文件末尾**追加新内容**   |

#####  `echo on` / `echo off` 

| 命令        | 作用说明                                                   |
| ----------- | ---------------------------------------------------------- |
| `echo on`   | 显示每条命令本身（默认行为）                               |
| `echo off`  | 不显示命令本身，只显示输出结果                             |
| `@echo off` | 通常写在脚本开头，关闭命令显示且连`echo off`这一行也不显示 |

##### 示例

```bash
echo Hello, world!
```

```bash
echo This is a log. >> log.txt
```

```bash
echo 'export const LdAjaxBaseUrl = "";' > ajaxBase.ts
```



#### `pasue`

暂停脚本执行，等待用户按任意键后继续。



#### `rem`

`rem` 是 Windows 批处理脚本中的**注释命令（remark）**，用于在脚本中添加注释说明，而不会被执行。

```bash
@echo off

rem 初始化脚本
echo 正在开始处理...

rem 写入数据到文件
echo hello > test.txt

rem 脚本结束
pause
```



#### `exit`

退出当前命令提示符窗口或脚本的命令

| 命令        | 功能                 |
| ----------- | -------------------- |
| `exit`      | 退出 CMD 或脚本      |
| `exit /b`   | 退出脚本但不关闭窗口 |
| `exit /b 1` | 返回错误码 1         |
| `exit /b 0` | 返回成功状态码 0     |



### 系统管理与配置

#### 常用命令

网络与端口

```bash
:: 查看所有端口占用情况
netstat -ano

:: 查看指定端口（如 8080）被谁占用
netstat -ano | findstr :8080
netstat -ano | findstr 8080

:: 根据 PID 查找对应的进程
tasklist | findstr <PID>
```



进程管理

```bash
:: 查看所有进程
tasklist

:: 结束指定程序（通过名称）
taskkill /IM notepad.exe /F

:: 结束指定程序（通过 PID）
taskkill /PID 1234 /F
tasklist | findstr 1234  
```



#### `netstat`

用于显示当前网络连接、端口使用情况、路由表等网络相关信息。

##### 常用参数

| 参数         | 说明                                       |
| ------------ | ------------------------------------------ |
| `-a`         | 显示所有连接和监听端口                     |
| `-n`         | 以数字形式显示地址和端口号（不解析域名）   |
| `-o`         | 显示与每个连接关联的 **PID（进程 ID）**    |
| `-e`         | 显示以太网统计信息（如包发/收数量）        |
| `-s`         | 显示每个协议的统计信息（TCP、UDP、ICMP）   |
| `-b`         | 显示创建连接的可执行文件（需要管理员权限） |
| `-r`         | 显示路由表（同 `route print`）             |
| `-p [proto]` | 指定协议（如 TCP、UDP）                    |
| `-f`         | 显示外部地址的完全限定域名（FQDN）         |

##### 常见用法

查看所有当前网络连接（含监听）

```bash
netstat -a
```

查看所有连接，**带进程 ID（PID）**

```bash
netstat -ano
```

查找哪个进程使用了端口

```bash
netstat -ano | findstr :8080
tasklist | findstr 1234   ← 查找 PID 为 1234 的进程
```

显示哪个程序（可执行文件）打开了端口（需管理员权限）

```bash
netstat -ab
```

显示路由表

```bash
netstat -r
```



#### `tasklist`

用于查看当前系统正在运行的所有进程（相当于任务管理器的“进程”标签页）。

##### 常用参数

| 参数           | 说明                             |
| -------------- | -------------------------------- |
| `/S <主机名>`  | 远程主机名（默认是本地）         |
| `/U <用户名>`  | 指定远程用户（需配合 `/S` 使用） |
| `/P <密码>`    | 指定远程用户密码                 |
| `/FI "筛选器"` | 使用筛选器（Filter）过滤结果     |
| `/FO <格式>`   | 输出格式：`TABLE`, `LIST`, `CSV` |
| `/NH`          | 不显示表头（配合 `/FO` 使用）    |

##### 常用命令

```bash
tasklist /FI "PID eq 1234"
```







#### `taskkill`

用于结束一个或多个正在运行的进程（等价于任务管理器中的“结束任务”）。

##### 常用参数

| 参数            | 说明                                     |
| --------------- | ---------------------------------------- |
| `/PID <进程ID>` | 指定要结束的进程 ID                      |
| `/IM <映像名>`  | 指定要结束的进程名称（如 `notepad.exe`） |
| `/F`            | 强制终止（推荐加上）                     |
| `/T`            | 连同子进程一起终止                       |
| `/S <主机名>`   | 指定远程主机                             |
| `/U <用户名>`   | 远程主机的用户名                         |
| `/P <密码>`     | 用户密码                                 |

##### 常用命令

结束指定进程（通过名称）

```bash
taskkill /IM notepad.exe /F
```

结束指定进程（通过 PID）

```bash
taskkill /PID 1234 /F
```

连同子进程一起结束（例如杀掉浏览器及其所有子进程）

```bash
taskkill /IM chrome.exe /F /T
```



#### `shutdown`

用来**关闭、重启或注销计算机**。

##### 常用参数详解

| 命令               | 作用说明                                            |
| ------------------ | --------------------------------------------------- |
| `shutdown /s`      | **关机**（Shut down）                               |
| `shutdown /r`      | **重启**（Restart）                                 |
| `shutdown /l`      | **注销**当前用户（Log off）                         |
| `shutdown /a`      | **取消关机**（Abort）                               |
| `shutdown /t 秒数` | 设置等待时间（单位：秒），最多 315360000 秒（10年） |
| `shutdown /f`      | **强制关闭**正在运行的应用程序                      |
| `shutdown /h`      | 使计算机**进入休眠状态**（Hibernate）               |
| `shutdown /?`      | 查看帮助文档                                        |

##### 示例

```bash
shutdown /s /f /t 0  -- 关机 强制关闭所有程序 0秒后执行（立即）
```

```bash
shutdown /r /t 60  -- 重启电脑，延迟 60 秒
```





#### `hostname`

显示计算机名称



### 文件与目录操作

#### `tree`

`tree` 命令用于以图形化的方式显示目录结构。它会递归地显示一个目录及其子目录，形成类似“树”的排列方式。

##### 参数说明

| 参数 | 说明                                                         |
| ---- | ------------------------------------------------------------ |
| 路径 | 指定要显示目录结构的起始位置（可以是绝对路径或相对路径）。默认是当前目录。 |
| `/f` | 显示每个目录中的**文件**（不仅仅是子目录）。                 |
| `/a` | 使用ASCII字符（如 `                                          |

##### 示例

显示 `D:\Projects` 下的目录结构

```bash
tree D:\Projects
```

显示目录及文件结构

```bash
tree /f
```



#### `dir`

列出当前目录下的文件和子目录。



##### 示例

显示当前目录下的所有文件，包括隐藏文件

```bash
dir /a
```

遍历所有子目录并列出所有文件

```bash
dir /s
```

显示所有 `.txt` 文件（支持通配符）

```bash
dir *.txt 
```



#### `cd`

`cd`（**Change Directory**）用于**显示或更改当前工作目录**。

`cd`等同于`pwd`

##### 常见用法

| 命令                | 含义                                     |
| ------------------- | ---------------------------------------- |
| `cd`                | 显示当前目录                             |
| `cd \`              | 切换到当前驱动器的根目录                 |
| `cd ..`             | 返回上一级目录                           |
| `cd foldername`     | 进入当前目录下名为 `foldername` 的子目录 |
| `cd C:\Users\Admin` | 进入指定的绝对路径目录                   |

##### 注意事项

- Windows 使用 `\` 分隔路径，而不是 Linux 的 `/`。

- 在批处理文件中，想切换驱动器（如从 `C:` 到 `D:`），你需要**单独执行驱动器字母**：

  ```bash
  D:
  cd D:\Projects
  ```

  直接写 `cd D:\Projects` 不会改变当前工作驱动器，必须先切换过去。

- 使用引号处理含有空格的路径

  ```bash
  cd "C:\Program Files"
  ```

  





### 网络相关命令

#### `ping`

`ping`（Packet Internet Groper）用于测试本机与目标主机之间的网络连接是否正常。

##### 常用参数

| 参数        | 说明                                      |
| ----------- | ----------------------------------------- |
| `-t`        | 持续发送 ping，直到用户手动停止（Ctrl+C） |
| `-n <次数>` | 指定发送的数据包数量                      |
| `-l <大小>` | 指定发送数据包的大小（字节）              |
| `-4`        | 强制使用 IPv4                             |
| `-6`        | 强制使用 IPv6                             |

##### 示例

```bash
ping 8.8.8.8 -t
ping www.baidu.com
```



#### `ipconfig`

`ipconfig`（Internet Protocol Configuration）用于显示和管理 Windows 系统的网络适配器信息。

##### 常用用途

- 查看本机 IP 地址、子网掩码、默认网关等信息
- 释放和更新 DHCP 分配的 IP 地址
- 查看 DNS 缓存













































